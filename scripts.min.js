document.addEventListener("DOMContentLoaded",function(){AOS.init({duration:1e3,once:!0}),document.getElementById("particles-js")&&particlesJS("particles-js",{particles:{number:{value:80},color:{value:"#ffffff"},shape:{type:"circle"},opacity:{value:.5},size:{value:3},move:{speed:3,direction:"none",random:!0}}});let e=0;const t=document.querySelectorAll(".slide"),a=document.querySelectorAll(".slider-dot");if(t.length>0&&a.length>0){function n(e){t.forEach(e=>e.classList.remove("active")),a.forEach(e=>e.classList.remove("active")),t[e].classList.add("active"),a[e].classList.add("active")}n(e),setInterval(function(){e=(e+1)%t.length,n(e)},5e3),a.forEach((t,a)=>{t.addEventListener("click",()=>{e=a,n(e)})})}const o=document.querySelectorAll(".tab-btn"),s=document.querySelectorAll(".tab-content");o.length>0&&s.length>0&&o.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-tab");o.forEach(e=>e.classList.remove("active")),s.forEach(e=>e.classList.remove("active")),e.classList.add("active"),document.getElementById(t)?.classList.add("active")})});const r=document.querySelector(".hamburger"),i=document.querySelector(".nav-links");r&&i&&r.addEventListener("click",()=>{i.classList.toggle("active");const e=r.querySelector("i");e&&(e.classList.toggle("fa-bars"),e.classList.toggle("fa-times"))});const l=document.querySelector(".navbar");l&&window.addEventListener("scroll",()=>{window.scrollY>100?l.classList.add("scrolled"):l.classList.remove("scrolled")});const c=document.querySelectorAll(".stat-number");c.length>0&&c.forEach(e=>{const t=e.getAttribute("data-target");if(!t)return;const a=parseInt(t),n=a/100;function o(){const t=parseInt(e.innerText||"0");t<a?(e.innerText=Math.ceil(t+n),setTimeout(o,20)):e.innerText=a}const s=new IntersectionObserver(e=>{e[0].isIntersecting&&(o(),s.unobserve(e[0].target))});s.observe(e)});const d=document.querySelector(".theme-toggle");if(d){const u=d.querySelector("i");if(u){const m=e=>{document.body.classList.toggle("dark-mode",e),u.classList.replace(e?"fa-moon":"fa-sun",e?"fa-sun":"fa-moon"),localStorage.setItem("theme",e?"dark":"light")};"dark"===localStorage.getItem("theme")&&m(!0);const p=()=>{const e=!document.body.classList.contains("dark-mode");m(e)};d.setAttribute("role","button"),d.setAttribute("tabindex","0"),d.setAttribute("aria-label","Toggle dark mode"),d.addEventListener("pointerup",p),d.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),p())})}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=this.getAttribute("href");if(!t||"#"===t)return;const a=document.querySelector(t);a&&a.scrollIntoView({behavior:"smooth",block:"start"})})}),"function"==typeof initGalleryFilter&&initGalleryFilter(),"function"==typeof initLightboxModal&&initLightboxModal(),"function"==typeof initSearchFeature&&initSearchFeature()}),document.querySelectorAll(".gallery-wrapper").forEach(e=>{const t=e.querySelector(".scroll-content"),a=e.querySelectorAll(".scroll-item"),n=e.querySelector(".prev"),o=e.querySelector(".next"),s=e.querySelector(".scroll-progress");if(!(t&&a.length&&n&&o&&s))return void console.error("Missing required elements in gallery");a.forEach(()=>{const e=document.createElement("div");e.className="progress-dot",s.appendChild(e)});const r=s.querySelectorAll(".progress-dot");r.length>0&&r[0].classList.add("active");const i=(()=>{const e=a[0];if(!e)return 332;const n=e.offsetWidth,o=window.getComputedStyle(t);return n+(parseFloat(o.gap)||32)})();n.addEventListener("click",()=>{t.scrollBy({left:-i,behavior:"smooth"})}),o.addEventListener("click",()=>{t.scrollBy({left:i,behavior:"smooth"})});t.addEventListener("scroll",()=>{const e=t.scrollLeft,n=t.scrollWidth-t.clientWidth,o=n>0?e/n:0,s=a.length,i=Math.round(o*(s-1));r.forEach((e,t)=>{e.classList.toggle("active",t===i)})});let l,c,d=!1;t.addEventListener("mousedown",e=>{d=!0,t.style.cursor="grabbing",l=e.pageX-t.offsetLeft,c=t.scrollLeft}),t.addEventListener("mouseleave",()=>{d=!1,t.style.cursor="grab"}),t.addEventListener("mouseup",()=>{d=!1,t.style.cursor="grab"}),t.addEventListener("mousemove",e=>{if(!d)return;e.preventDefault();const a=2*(e.pageX-t.offsetLeft-l);t.scrollLeft=c-a})});const form=document.getElementById("form"),result=document.getElementById("result"),submitBtn=form?.querySelector(".submit-button");function initGalleryFilter(){const e=document.querySelectorAll(".gallery-filters button"),t=document.querySelectorAll(".gallery-item"),a=document.querySelector(".gallery-grid");if(!e.length||!t.length)return;const n=document.createElement("div");n.className="gallery-counter",n.innerHTML=`<span>${t.length}</span> items displayed`;const o=document.querySelector(".gallery-filters");function s(e){let o=0;var s;t.forEach(t=>{"all"===e||t.getAttribute("data-category")===e?(t.classList.remove("hide"),setTimeout(()=>{t.classList.add("show")},10),o++):(t.classList.remove("show"),setTimeout(()=>{t.classList.add("hide")},10))}),s=o,n&&(n.innerHTML=`<span>${s}</span> item${1!==s?"s":""} displayed`),a&&setTimeout(()=>{a.classList.add("filtered"),setTimeout(()=>a.classList.remove("filtered"),300)},300)}o&&o.parentNode&&o.parentNode.insertBefore(n,o.nextSibling),t.forEach(e=>{e.classList.add("filter-animation")}),e.forEach(t=>{t.addEventListener("click",()=>{e.forEach(e=>e.classList.remove("active")),t.classList.add("active");s(t.getAttribute("data-filter"))})}),s("all")}function initLightboxModal(){const e=document.getElementById("modal"),t=document.getElementById("modalImg"),a=document.getElementById("modalCaption"),n=document.getElementById("modalClose"),o=document.getElementById("modalNext"),s=document.getElementById("modalPrev");if(e&&t&&a&&n){e.style.display="none",e.style.flexDirection="column";const c=document.createElement("div");c.id="modalCounter",c.style.color="#fff",c.style.textAlign="center",c.style.margin="10px 0",c.style.fontSize="0.9rem",c.style.opacity="0.8";const d=document.getElementById("downloadImg"),u=e.querySelector(".modal-container");u&&u.appendChild(c);const m=document.querySelectorAll(".gallery-item"),p=Array.from(m).map(e=>e.querySelector("img"));let g=0;if(0===p.length)return;function r(e){const n=p[e];if(!n)return;t.src=n.src,t.style.display="block";const o=n.closest(".gallery-item"),s=o?o.querySelector(".overlay"):null;a.innerHTML=s?s.innerHTML:n.alt||"",c.textContent=`Image ${e+1} of ${p.length}`}function i(e,t=!1){const a=document.createElement("div");a.textContent=e,a.style.position="fixed",a.style.bottom="20px",a.style.left="50%",a.style.transform="translateX(-50%)",a.style.backgroundColor=t?"rgba(220, 53, 69, 0.9)":"rgba(40, 167, 69, 0.9)",a.style.color="white",a.style.padding="10px 20px",a.style.borderRadius="5px",a.style.zIndex="10000",document.body.appendChild(a),setTimeout(()=>{a.style.opacity="0",a.style.transition="opacity 0.5s ease",setTimeout(()=>document.body.removeChild(a),500)},2e3)}function l(){e.classList.remove("active"),setTimeout(()=>{e.style.display="none"},300)}p.forEach((t,a)=>{if(!t)return;t.style.cursor="pointer";const n=t.cloneNode(!0);t.parentNode&&t.parentNode.replaceChild(n,t),n.addEventListener("click",t=>{t.stopPropagation(),g=a,function(t){e.style.display="flex",r(t),setTimeout(()=>{e.classList.add("active")},10)}(g)})}),o&&o.addEventListener("click",e=>{e.stopPropagation(),t.classList.add("slide-out-left"),setTimeout(()=>{g=(g+1)%p.length,r(g),t.classList.remove("slide-out-left"),t.classList.add("slide-in-right"),setTimeout(()=>{t.classList.remove("slide-in-right")},300)},300)}),s&&s.addEventListener("click",e=>{e.stopPropagation(),t.classList.add("slide-out-right"),setTimeout(()=>{g=(g-1+p.length)%p.length,r(g),t.classList.remove("slide-out-right"),t.classList.add("slide-in-left"),setTimeout(()=>{t.classList.remove("slide-in-left")},300)},300)}),d&&d.addEventListener("click",async e=>{e.stopPropagation(),e.preventDefault();try{const e=t.src;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){const t=await fetch(e),a=await t.blob(),n=window.URL.createObjectURL(a);if(navigator.share)try{return void await navigator.share({files:[new File([a],"image.jpg",{type:a.type})]})}catch(e){console.log("Fallback to direct download")}if(navigator.userAgent.match(/iPhone|iPad|iPod/i)){const e=new FileReader;e.onloadend=function(){const t=document.createElement("a");t.href=e.result,t.download=`image-${g+1}.jpg`,t.target="_self",t.rel="noopener noreferrer",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(n)},e.readAsDataURL(a)}else{const e=document.createElement("a");e.href=n,e.download=`image-${g+1}.jpg`,e.target="_self",e.rel="noopener noreferrer",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(n)}}else{const a=document.createElement("a");if(e.startsWith("http")&&!e.includes(window.location.hostname)){const n=document.createElement("canvas"),o=n.getContext("2d");n.width=t.naturalWidth,n.height=t.naturalHeight,o.drawImage(t,0,0);try{a.href=n.toDataURL("image/jpeg",.8)}catch(t){const n=await fetch(e),o=await n.blob();a.href=URL.createObjectURL(o)}}else a.href=e;a.download=`image-${g+1}.jpg`,a.target="_self",a.rel="noopener noreferrer",document.body.appendChild(a),setTimeout(()=>{a.click(),document.body.removeChild(a)},0)}i("Image downloaded successfully!")}catch(e){console.error("Download error:",e),i("Download failed. Please try again.",!0)}}),n.addEventListener("click",e=>{e.stopPropagation(),l()}),e.addEventListener("click",t=>{t.target===e&&l()}),document.addEventListener("keydown",t=>{if("none"!==e.style.display)switch(t.key){case"ArrowRight":o?.click();break;case"ArrowLeft":s?.click();break;case"Escape":l()}});let h=0,y=0;e.addEventListener("touchstart",e=>{h=e.changedTouches[0].screenX}),e.addEventListener("touchend",e=>{y=e.changedTouches[0].screenX,function(){const e=50;y<h-e&&o?.click();y>h+e&&s?.click()}()})}}function initSearchFeature(){const e=document.querySelectorAll(".search-box"),t=document.querySelectorAll('.search-box input[type="search"]'),a=document.querySelector(".content"),n=document.querySelector(".sidebar");if(!(e.length&&t.length&&a&&n))return;const o={category:null,date:null};let s,r="newest";const i=function(){const e=document.createElement("div");e.className="search-results",e.innerHTML='\n            <div class="search-loading">\n                <div class="spinner"></div>\n                <p>Searching...</p>\n            </div>\n        ';const t=document.createElement("div");t.className="search-status",e.appendChild(t);const o=document.createElement("div");o.className="results-container",e.appendChild(o);const s=document.createElement("button");s.className="back-to-posts",s.innerHTML='<i class="fas fa-arrow-left"></i> Back to All Posts',s.style.display="none",e.appendChild(s);const r=document.createElement("div");r.className="search-filters",r.innerHTML='\n            <h3>Filter Results</h3>\n            <div class="filter-options">\n                <div class="filter-group">\n                    <label>Category:</label>\n                    <select class="category-filter">\n                        <option value="">All Categories</option>\n                    </select>\n                </div>\n                <div class="filter-group">\n                    <label>Date Range:</label>\n                    <select class="date-filter">\n                        <option value="">All Time</option>\n                        <option value="7">Last 7 Days</option>\n                        <option value="30">Last 30 Days</option>\n                        <option value="90">Last 3 Months</option>\n                        <option value="365">Last Year</option>\n                    </select>\n                </div>\n            </div>\n        ',n.appendChild(r);const i=document.createElement("div");return i.className="sort-options",i.innerHTML='\n            <label>Sort by:</label>\n            <select class="sort-select">\n                <option value="newest">Newest First</option>\n                <option value="oldest">Oldest First</option>\n                <option value="relevance">Relevance</option>\n            </select>\n        ',r.appendChild(i),a.parentNode.insertBefore(e,a.nextSibling),e.style.display="none",{searchResults:e,backButton:s,searchStatus:t,filterContainer:r,sortOptions:i}}(),{searchResults:l,backButton:c,searchStatus:d,filterContainer:u,sortOptions:m}=i,p=[{id:1,title:"Celebrating Excellence at Lady Of Mercy Preparatory School",content:"This November, Lady Of Mercy Preparatory School proudly celebrates another year of academic excellence with outstanding achievements across all departments. Our students have demonstrated exceptional dedication to their studies and extracurricular activities.",date:"November 25, 2024",timestamp:new Date("2024-11-25").getTime(),author:"Samuel Frimpong",category:"academic, events",image:"https://picsum.photos/800/500?random=1",imageAlt:"Students receiving academic excellence awards",tags:["excellence","awards","academics"],href:"celebrating-excellence.html"},{id:2,title:"Lady Of Mercy Achieves Outstanding BECE Results",content:"Lady Of Mercy Preparatory School is proud to announce our exceptional achievement in the 2023 Basic Education Certificate Examination (BECE). Our students have once again demonstrated remarkable academic prowess with 95% of candidates scoring distinction grades across all subjects.",date:"November 15, 2024",timestamp:new Date("2024-11-15").getTime(),author:"Samuel Frimpong",category:"achievements",image:"https://picsum.photos/800/500?random=2",imageAlt:"Students celebrating BECE examination results",tags:["BECE","examination","results"],href:"bece-results-2023.html"},{id:3,title:"Annual Sports Festival Showcases Athletic Talent",content:"The annual Lady Of Mercy Sports Festival concluded last week with spectacular displays of athletic talent across various sporting disciplines. Students competed in track and field events, swimming, basketball, and football.",date:"October 30, 2024",timestamp:new Date("2024-10-30").getTime(),author:"Charles Boakye",category:"sports",image:"https://picsum.photos/800/500?random=3",imageAlt:"Students participating in sports activities during the festival",tags:["sports","athletics","competition"],href:"sports-day-2024.html"},{id:4,title:"New Science Laboratory Inaugurated",content:"Lady Of Mercy Preparatory School has inaugurated a state-of-the-art science laboratory equipped with modern facilities to enhance practical learning experiences for our students. The new laboratory features advanced equipment for physics, chemistry, and biology experiments.",date:"October 15, 2024",timestamp:new Date("2024-10-15").getTime(),author:"Micheal Jackson",category:"facilities",image:"https://picsum.photos/800/500?random=4",imageAlt:"New science laboratory with modern equipment",tags:["science","laboratory","facilities","innovation"],href:"new-science-lab.html"},{id:5,title:"Cultural Day Celebration Highlights Diversity",content:"The annual Cultural Day celebration at Lady Of Mercy Preparatory School showcased the rich cultural diversity within our school community. Students presented traditional dances, music, food, and attire from various ethnic backgrounds, promoting cultural awareness and appreciation.",date:"September 28, 2024",timestamp:new Date("2024-09-28").getTime(),author:"Akosua Mensah",category:"events",image:"https://picsum.photos/800/500?random=5",imageAlt:"Students in traditional attire during Cultural Day celebration",tags:["culture","diversity","celebration","tradition"],href:"cultural-day.html"},{id:6,title:"Admissions Open for 2025 Academic Year",content:"Lady Of Mercy Preparatory School is now accepting applications for the 2025 academic year. We invite parents and guardians to enroll their children in our esteemed institution, known for its commitment to academic excellence and holistic development.",date:"April 3, 2025",timestamp:new Date("2025-04-3").getTime(),author:"Mr.Charles Boakye",category:"academic",image:"https://picsum.photos/800/500?random=6",imageAlt:"Admissions open for 2025 academic year at Lady Of Mercy Preparatory School",tags:["culture","diversity","celebration","tradition"],href:"admission.html"},{id:7,title:"Mission, Vision and Mode Of Education",content:"Lady Of Mercy Preparatory School's mission is to provide a nurturing and stimulating environment that fosters academic excellence, character development, and social responsibility. Our vision is to be a leading educational institution that empowers students to become lifelong learners and responsible citizens.",date:"March 7, 2025",timestamp:new Date("2025-03-7").getTime(),author:"Mr.Charles Boakye",category:"academic",image:"https://picsum.photos/800/500?random=6",imageAlt:"Mission, Vision and Mode Of Education at Lady Of Mercy Preparatory School",tags:["culture","diversity","celebration","tradition"],href:"mission.html"}];function g(){const e=t[0].value.toLowerCase().trim();if(e.length<2&&!o.category&&!o.date)return void function(e){let t=document.querySelector(".search-notification");t||(t=document.createElement("div"),t.className="search-notification",document.body.appendChild(t));t.textContent=e,t.classList.add("active"),setTimeout(()=>t.classList.remove("active"),3e3)}("Please enter at least 2 characters to search");v();const a=h(e),n=l.querySelector(".search-loading");n&&(n.style.display="flex"),setTimeout(()=>{y(a,e),n&&(n.style.display="none")},300)}function h(e){let t=[...p];if(e.length>=2&&(t=t.filter(t=>{const a=[t.title,t.content,t.category].some(t=>t&&t.toLowerCase().includes(e)),n=t.tags&&t.tags.some(t=>t.toLowerCase().includes(e));let o=!1;if(t.image){const a=t.image.toLowerCase(),n=a.split("/").pop().split(".")[0];o=a.includes(e)||n.includes(e),o=t.imageAlt?o||t.imageAlt.toLowerCase().includes(e):o||t.title.toLowerCase().includes(e)}return a||n||o})),o.category&&(t=t.filter(e=>{if(!e.category)return!1;if(e.category.includes(",")){return e.category.split(",").map(e=>e.trim()).includes(o.category)}return e.category===o.category})),o.date){const e=Date.now()-24*o.date*60*60*1e3;t=t.filter(t=>t.timestamp>=e)}return function(e,t){if("newest"===r)return e.sort((e,t)=>t.timestamp-e.timestamp);if("oldest"===r)return e.sort((e,t)=>e.timestamp-t.timestamp);if("relevance"===r&&t.length>=2)return e.sort((e,a)=>{const n=e.title.toLowerCase().includes(t)?1:0;return(a.title.toLowerCase().includes(t)?1:0)-n||a.timestamp-e.timestamp});return e}(t,e)}function y(e,t){const a=l.querySelector(".search-loading");a&&(a.style.display="none");const n=l.querySelector(".results-container");n&&(!function(e,t){if(!d)return;d.textContent=t?`Found ${e} result${1!==e?"s":""} for "${t}"`:`Showing ${e} result${1!==e?"s":""}`}(e.length,t),0===e.length?n.innerHTML='\n                <div class="no-results">\n                    <i class="fas fa-search-minus"></i>\n                    <p>No results found for your search.</p>\n                    <p class="search-suggestion">Try using different keywords or removing filters.</p>\n                    <p class="search-suggestion">You can also search for images by their description or category.</p>\n                </div>\n            ':n.innerHTML=e.map(e=>`\n                    <div class="result-item" data-id="${e.id}">\n                        ${e.image?`\n                            <div class="result-image">\n                                <img src="${e.image}" alt="${e.imageAlt||e.title}" loading="lazy">\n                            </div>\n                        `:""}\n                        <div class="result-content">\n                            <h3>${f(e.title,t)}</h3>\n                            <p>${f(e.content.substring(0,150)+"...",t)}</p>\n                            <div class="result-meta">\n                                <span class="result-date"><i class="far fa-calendar-alt"></i> ${e.date}</span>\n                                <span class="result-author"><i class="far fa-user"></i> ${e.author}</span>\n                                <span class="result-category"><i class="far fa-folder"></i> ${e.category}</span>\n                                ${e.tags&&e.tags.length>0?`\n                                    <span class="result-tags"><i class="fas fa-tags"></i> ${e.tags.map(e=>f(e,t)).join(", ")}</span>\n                                `:""}\n                            </div>\n                             <a href="${e.href}" class="read-more">Read More</a>\n                        </div>\n                    </div>\n                `).join(""),window.innerWidth<=992&&setTimeout(()=>{l.scrollIntoView({behavior:"smooth",block:"start"})},300))}function f(e,t){if(!t||!e)return e||"";const a=new RegExp(`(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return e.replace(a,"<mark>$1</mark>")}function v(){a.style.display="none",l.style.display="flex",l.classList.add("active"),c.style.display="block",n.classList.add("search-active"),window.innerWidth<=992&&setTimeout(()=>{const e=document.querySelector(".search-box");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},100)}function b(){a.style.display="block",l.style.display="none",l.classList.remove("active"),c.style.display="none",n.classList.remove("search-active"),t.forEach(e=>{e.value=""});const e=document.querySelector(".category-filter");e&&(e.value="");const s=document.querySelector(".date-filter");s&&(s.value="");const i=document.querySelector(".sort-select");i&&(i.value="newest"),o.category=null,o.date=null,r="newest"}function L(){const e=t[0].value.toLowerCase().trim();v();y(h(e),e)}!function(e){const t=document.querySelector(".category-filter");if(!t)return;e.forEach(e=>{const a=document.createElement("option");a.value=e,a.textContent=e.charAt(0).toUpperCase()+e.slice(1),t.appendChild(a)})}([...new Set(p.map(e=>e.category&&e.category.includes(",")?e.category.split(",").map(e=>e.trim()):e.category).flat().filter(Boolean))]),function(){e.forEach(e=>{e.addEventListener("submit",e=>{e.preventDefault(),g()})}),t.forEach(e=>{e.addEventListener("input",e=>{const a=e.target.value;t.forEach(t=>{t!==e.target&&(t.value=a)}),clearTimeout(s);const n=l.querySelector(".search-loading");n&&(n.style.display="flex"),s=setTimeout(()=>{a.trim().length>=2?g():0===a.trim().length&&b()},300)})}),c.addEventListener("click",e=>{e.stopPropagation(),b()});const a=document.querySelector(".category-filter");a&&a.addEventListener("change",e=>{o.category=e.target.value,L()});const n=document.querySelector(".date-filter");n&&n.addEventListener("change",e=>{o.date=e.target.value,L()});const i=document.querySelector(".sort-select");i&&i.addEventListener("change",e=>{r=e.target.value,L()});document.addEventListener("keydown",e=>{l.classList.contains("active")&&"Escape"===e.key&&b()})}()}form&&result&&submitBtn&&form.addEventListener("submit",async function(e){e.preventDefault(),submitBtn.disabled=!0,submitBtn.textContent="Sending...",result.className="loading fade-in",result.textContent="Please wait...";try{const e=new FormData(form),t=Object.fromEntries(e),a=JSON.stringify(t),n=await fetch("https://api.web3forms.com/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:a}),o=await n.json();if(200!==n.status)throw new Error(o.message||"Something went wrong!");result.className="success fade-in",result.textContent="Message sent successfully!",form.reset()}catch(e){console.error(e),result.className="error fade-in",result.textContent=e.message}finally{submitBtn.disabled=!1,submitBtn.textContent="Send Message",setTimeout(()=>{result.style.opacity="0",setTimeout(()=>{result.textContent="",result.className="",result.style.opacity="1"},300)},3e3)}});